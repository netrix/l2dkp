(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[792],{7083:function(e,n,t){Promise.resolve().then(t.bind(t,3922))},3922:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return J}});var r=t(9268),i=t(6006),o=t(1771),s=t(4240),l=t(7931),a=t(1301),d=t(1387),c=t(3658),h=t(4274),x=t(8399),u=t(8992),p=t(6564),j=t(5991),Z=t(5287),g=t(1947),m=t(9714),f=t(1333),v=t(3210),C=t(8350),b=t(383),y=t(8843);function w(e){let{raidInfo:n}=e,[t,l]=i.useState(!1);return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)(p.Z,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,r.jsx)(h.Z,{component:"th",scope:"row",children:n.date}),(0,r.jsx)(h.Z,{align:"left",children:n.name}),(0,r.jsx)(h.Z,{align:"right",children:n.drops.length}),(0,r.jsx)(h.Z,{align:"right",children:n.people.length}),(0,r.jsx)(h.Z,{children:(0,r.jsx)(m.Z,{"aria-label":"expand row",size:"small",onClick:()=>l(!t),children:t?(0,r.jsx)(y.Z,{}):(0,r.jsx)(b.Z,{})})})]}),(0,r.jsx)(p.Z,{children:(0,r.jsx)(h.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:(0,r.jsx)(f.Z,{in:t,timeout:"auto",unmountOnExit:!0,children:(0,r.jsxs)(o.Z,{sx:{margin:1},children:[(0,r.jsx)(s.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"Drops"}),(0,r.jsx)(v.Z,{children:n.drops.map(e=>(0,r.jsx)(C.ZP,{children:e},e))}),(0,r.jsx)(s.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"People"}),(0,r.jsx)(v.Z,{children:n.people.map(e=>(0,r.jsx)(C.ZP,{children:e},e))})]})})})})]})}var k=t(4827),B=t(3984),R=t(2945),P=t(2099),A=t(9822),S=t(6588),N=t(3964),O=t(6902),T=t.n(O);function E(e){let{value:n,onChange:t}=e;return(0,r.jsx)(R._,{dateAdapter:B.y,children:(0,r.jsx)(P.M,{label:"Raid date",value:n,onChange:t})})}function F(e){let{initName:n,forbiddenNames:t,onConfirm:o,onCancel:s}=e,[a,d]=i.useState(n),[c,h]=i.useState(!1);function x(){a&&!c&&o(a)}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.Z,{autoFocus:!0,defaultValue:n,error:c,onChange:e=>{let n=e.target.value;d(n),h(t.includes(n))},onKeyPress:e=>{"Enter"===e.key&&x()}}),(0,r.jsx)(l.Z,{variant:"contained",onClick:x,children:(0,r.jsx)(S.Z,{})}),(0,r.jsx)(l.Z,{variant:"contained",color:"error",onClick:()=>{s()},children:(0,r.jsx)(N.Z,{})})]})}function _(e){let{names:n,onChange:t}=e,[o,s]=i.useState(!1);return(0,r.jsxs)(v.Z,{children:[n.map(e=>(0,r.jsx)(C.ZP,{children:e},e)),o?(0,r.jsx)(C.ZP,{children:(0,r.jsx)(F,{initName:"",forbiddenNames:n,onConfirm:e=>{t(n.concat(e)),s(!1)},onCancel:()=>s(!1)})}):(0,r.jsx)(C.ZP,{children:(0,r.jsx)(l.Z,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(a.Z,{}),onClick:()=>{s(!0)},children:"Add"})})]})}function q(e){var n;let[t,a]=i.useState((n=e.raidInfo,{date:T()(null==n?void 0:n.date),name:(null==n?void 0:n.date)||"",drops:(null==n?void 0:n.drops)||[],people:(null==n?void 0:n.people)||[]}));return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)(p.Z,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,r.jsx)(h.Z,{component:"th",scope:"row",align:"left",children:(0,r.jsx)(E,{value:t.date,onChange:e=>{a({...t,date:e})}})}),(0,r.jsx)(h.Z,{align:"left",children:(0,r.jsx)(A.Z,{id:"outlined-basic",label:"Raid name",variant:"outlined",onChange:e=>{a({...t,name:e.target.value})}})}),(0,r.jsx)(h.Z,{align:"right",children:t.drops.length}),(0,r.jsx)(h.Z,{align:"right",children:t.people.length})]}),(0,r.jsx)(p.Z,{children:(0,r.jsxs)(h.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:[(0,r.jsxs)(o.Z,{sx:{margin:1},children:[(0,r.jsx)(s.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"Drops"}),(0,r.jsx)(_,{names:t.drops,onChange:e=>{a({...t,drops:e})}}),(0,r.jsx)(s.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"People"}),(0,r.jsx)(_,{names:t.people,onChange:e=>{a({...t,people:e})}})]}),(0,r.jsxs)(o.Z,{sx:{margin:"16px",display:"flex",justifyContent:"right"},children:[(0,r.jsx)(l.Z,{variant:"contained",color:"error",onClick:()=>e.onCancel(),children:"Cancel"}),(0,r.jsx)(l.Z,{variant:"contained",color:"primary",onClick:()=>{e.onAccept({date:t.date.format(),name:t.name,drops:t.drops,people:t.people})},children:"Add"})]})]})})]})}let D=(0,Z.Z)({components:{MuiTableCell:{styleOverrides:{root:{fontWeight:"bold"}}}}});function I(e){let{showAddButton:n,onAddButtonClick:t}=e;return(0,r.jsxs)(o.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",padding:2},children:[(0,r.jsx)(s.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"Raids"}),n&&(0,r.jsx)(l.Z,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(a.Z,{}),onClick:t,children:"Add"})]})}function U(){return(0,r.jsx)(g.Z,{theme:D,children:(0,r.jsx)(u.Z,{children:(0,r.jsxs)(p.Z,{children:[(0,r.jsx)(h.Z,{align:"left",children:"Date"}),(0,r.jsx)(h.Z,{children:"Raid name"}),(0,r.jsx)(h.Z,{align:"right",children:"Drops"}),(0,r.jsx)(h.Z,{align:"right",children:"People"}),(0,r.jsx)(h.Z,{})]})})})}function M(e){let{raids:n,isAddMode:t,onRaidEditAccept:i,onRaidEditCancel:o}=e;return(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsx)(q,{onAccept:i,onCancel:o}),n.map(e=>(0,r.jsx)(w,{raidInfo:e},e.name))]})}function L(e){let{message:n}=e;return(0,r.jsx)(p.Z,{sx:{"& > *":{borderBottom:"unset"}},children:(0,r.jsx)(h.Z,{scope:"row",align:"left",children:(0,r.jsxs)("p",{children:["Oh no, there was an error ",n]})})})}function z(){return(0,r.jsx)(p.Z,{sx:{"& > *":{borderBottom:"unset"}},children:(0,r.jsx)(h.Z,{scope:"row",align:"left",children:(0,r.jsx)("p",{children:"Loading..."})})})}function J(){let[e,n]=i.useState(!1),[t,o]=(0,k.Ub)(),{isLoading:s,isFetching:l,data:a,error:h}=(0,k.q7)(null);return(0,r.jsxs)(j.Z,{elevation:1,sx:{width:"60%"},children:[(0,r.jsx)(I,{showAddButton:!e&&!s&&!s&&!h,onAddButtonClick:()=>n(!0)}),(0,r.jsx)(x.Z,{component:j.Z,children:(0,r.jsxs)(d.Z,{"aria-label":"collapsible table",children:[(0,r.jsx)(U,{}),(0,r.jsx)(c.Z,{children:h?(0,r.jsx)(L,{message:JSON.stringify(h)}):s||l?(0,r.jsx)(z,{}):a?(0,r.jsx)(M,{raids:a,isAddMode:e,onRaidEditAccept:function(e){t(e).unwrap().then(()=>{}).then(e=>{console.log("addNewRaid:",e)}),n(!1)},onRaidEditCancel:()=>n(!1)}):null})]})})]})}},4827:function(e,n,t){"use strict";t.d(n,{Ub:function(){return l},db:function(){return o},q7:function(){return s}});var r=t(9764),i=t(1452);let o=(0,r.LC)({reducerPath:"raidsApi",refetchOnFocus:!0,baseQuery:(0,i.ni)({baseUrl:"/api"}),tagTypes:["Raid"],endpoints:e=>({getRaids:e.query({query:()=>"raids/v1",transformResponse:e=>e.raids,providesTags:["Raid"]}),addNewRaid:e.mutation({query:e=>({url:"raids/v1",method:"POST",body:e,header:{"Content-type":"application/json; charset=UTF-8"}}),invalidatesTags:["Raid"]})})}),{useGetRaidsQuery:s,useAddNewRaidMutation:l}=o}},function(e){e.O(0,[632,108,462,764,895,826,667,139,560],function(){return e(e.s=7083)}),_N_E=e.O()}]);