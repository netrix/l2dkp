(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[792],{7083:function(e,n,t){Promise.resolve().then(t.bind(t,3922))},3922:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return K}});var r=t(9268),i=t(6006),s=t(1771),o=t(4240),a=t(7931),l=t(1301),d=t(1387),c=t(3658),h=t(4274),x=t(8399),u=t(8992),j=t(6564),p=t(5991),Z=t(5287),g=t(1947),m=t(9714),f=t(1333),v=t(3210),C=t(8350),y=t(383),b=t(8843);function R(e){let{raidInfo:n}=e,[t,a]=i.useState(!1);return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)(j.Z,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,r.jsx)(h.Z,{component:"th",scope:"row",children:n.date}),(0,r.jsx)(h.Z,{align:"left",children:n.name}),(0,r.jsx)(h.Z,{align:"right",children:n.drops.length}),(0,r.jsx)(h.Z,{align:"right",children:n.people.length}),(0,r.jsx)(h.Z,{children:(0,r.jsx)(m.Z,{"aria-label":"expand row",size:"small",onClick:()=>a(!t),children:t?(0,r.jsx)(b.Z,{}):(0,r.jsx)(y.Z,{})})})]}),(0,r.jsx)(j.Z,{children:(0,r.jsx)(h.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:(0,r.jsx)(f.Z,{in:t,timeout:"auto",unmountOnExit:!0,children:(0,r.jsxs)(s.Z,{sx:{margin:1},children:[(0,r.jsx)(o.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"Drops"}),(0,r.jsx)(v.Z,{children:n.drops.map(e=>(0,r.jsx)(C.ZP,{children:e},e))}),(0,r.jsx)(o.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"People"}),(0,r.jsx)(v.Z,{children:n.people.map(e=>(0,r.jsx)(C.ZP,{children:e},e))})]})})})})]})}var w=t(4827),k=t(3984),B=t(2945),P=t(2099),A=t(9822),S=t(6588),T=t(3964),D=t(6902),N=t.n(D);function O(e){let{value:n,onChange:t}=e;return(0,r.jsx)(B._,{dateAdapter:k.y,children:(0,r.jsx)(P.M,{label:"Raid date",value:n,onChange:t})})}function E(e){let{initName:n,forbiddenNames:t,onConfirm:s,onCancel:o}=e,[l,d]=i.useState(n),[c,h]=i.useState(!1);function x(){l&&!c&&s(l)}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.Z,{autoFocus:!0,defaultValue:n,error:c,onChange:e=>{let n=e.target.value;d(n),h(t.includes(n))},onKeyPress:e=>{"Enter"===e.key&&x()}}),(0,r.jsx)(a.Z,{variant:"contained",onClick:x,children:(0,r.jsx)(S.Z,{})}),(0,r.jsx)(a.Z,{variant:"contained",color:"error",onClick:()=>{o()},children:(0,r.jsx)(T.Z,{})})]})}function F(e){let{names:n,onChange:t}=e,[s,o]=i.useState(!1);return(0,r.jsxs)(v.Z,{children:[n.map(e=>(0,r.jsx)(C.ZP,{children:e},e)),s?(0,r.jsx)(C.ZP,{children:(0,r.jsx)(E,{initName:"",forbiddenNames:n,onConfirm:e=>{t(n.concat(e)),o(!1)},onCancel:()=>o(!1)})}):(0,r.jsx)(C.ZP,{children:(0,r.jsx)(a.Z,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(l.Z,{}),onClick:()=>{o(!0)},children:"Add"})})]})}function _(e){var n;let[t,l]=i.useState((n=e.raidInfo,{date:N()(null==n?void 0:n.date),name:(null==n?void 0:n.date)||"",drops:(null==n?void 0:n.drops)||[],people:(null==n?void 0:n.people)||[]}));return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsxs)(j.Z,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,r.jsx)(h.Z,{component:"th",scope:"row",align:"left",children:(0,r.jsx)(O,{value:t.date,onChange:e=>{l({...t,date:e})}})}),(0,r.jsx)(h.Z,{align:"left",children:(0,r.jsx)(A.Z,{id:"outlined-basic",label:"Raid name",variant:"outlined",onChange:e=>{l({...t,name:e.target.value})}})}),(0,r.jsx)(h.Z,{align:"right",children:t.drops.length}),(0,r.jsx)(h.Z,{align:"right",children:t.people.length})]}),(0,r.jsx)(j.Z,{children:(0,r.jsxs)(h.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:[(0,r.jsxs)(s.Z,{sx:{margin:1},children:[(0,r.jsx)(o.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"Drops"}),(0,r.jsx)(F,{names:t.drops,onChange:e=>{l({...t,drops:e})}}),(0,r.jsx)(o.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"People"}),(0,r.jsx)(F,{names:t.people,onChange:e=>{l({...t,people:e})}})]}),(0,r.jsxs)(s.Z,{sx:{margin:"16px",display:"flex",justifyContent:"right"},children:[(0,r.jsx)(a.Z,{variant:"contained",color:"error",onClick:()=>e.onCancel(),children:"Cancel"}),(0,r.jsx)(a.Z,{variant:"contained",color:"primary",onClick:()=>{e.onAccept({date:t.date.format(),name:t.name,drops:t.drops,people:t.people})},children:"Add"})]})]})})]})}var q=t(8921);let I=(0,Z.Z)({components:{MuiTableCell:{styleOverrides:{root:{fontWeight:"bold"}}}}});function U(e){let{showAddButton:n,onAddButtonClick:t,onRefreshButtonClick:i}=e;return(0,r.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignContent:"center",padding:1},children:[(0,r.jsx)(o.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"Raids"}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"right"},children:[(0,r.jsx)(a.Z,{variant:"contained",color:"secondary",onClick:i,sx:{marginRight:1},children:(0,r.jsx)(q.Z,{})}),n&&(0,r.jsx)(a.Z,{variant:"contained",color:"primary",startIcon:(0,r.jsx)(l.Z,{}),onClick:t,children:"Add"})]})]})}function z(){return(0,r.jsx)(g.Z,{theme:I,children:(0,r.jsx)(u.Z,{children:(0,r.jsxs)(j.Z,{children:[(0,r.jsx)(h.Z,{align:"left",children:"Date"}),(0,r.jsx)(h.Z,{children:"Raid name"}),(0,r.jsx)(h.Z,{align:"right",children:"Drops"}),(0,r.jsx)(h.Z,{align:"right",children:"People"}),(0,r.jsx)(h.Z,{})]})})})}function M(e){let{raids:n,isAddMode:t,onRaidEditAccept:i,onRaidEditCancel:s}=e;return(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsx)(_,{onAccept:i,onCancel:s}),n.map(e=>(0,r.jsx)(R,{raidInfo:e},e.name))]})}function L(e){let{message:n}=e;return(0,r.jsx)(j.Z,{sx:{"& > *":{borderBottom:"unset"}},children:(0,r.jsx)(h.Z,{scope:"row",align:"left",children:(0,r.jsxs)("p",{children:["Oh no, there was an error ",n]})})})}function J(){return(0,r.jsx)(j.Z,{sx:{"& > *":{borderBottom:"unset"}},children:(0,r.jsx)(h.Z,{scope:"row",align:"left",children:(0,r.jsx)("p",{children:"Loading..."})})})}function K(){let[e,n]=i.useState(!1),[t,s]=(0,w.Ub)(),[o,a]=(0,w.zD)(),{isLoading:l,isFetching:h,data:u,error:j}=(0,w.q7)(null);return(0,r.jsxs)(p.Z,{elevation:1,sx:{width:"60%"},children:[(0,r.jsx)(U,{showAddButton:!e&&!l&&!l&&!j,onAddButtonClick:()=>n(!0),onRefreshButtonClick:()=>o(null)}),(0,r.jsx)(x.Z,{component:p.Z,children:(0,r.jsxs)(d.Z,{"aria-label":"collapsible table",children:[(0,r.jsx)(z,{}),(0,r.jsx)(c.Z,{children:j?(0,r.jsx)(L,{message:JSON.stringify(j)}):l||h?(0,r.jsx)(J,{}):u?(0,r.jsx)(M,{raids:u,isAddMode:e,onRaidEditAccept:function(e){t(e).unwrap().then(()=>{}).then(e=>{console.log("addNewRaid:",e)}),n(!1)},onRaidEditCancel:()=>n(!1)}):null})]})})]})}},4827:function(e,n,t){"use strict";t.d(n,{Ub:function(){return a},db:function(){return s},q7:function(){return o},zD:function(){return l}});var r=t(9764),i=t(1452);let s=(0,r.LC)({reducerPath:"raidsApi",refetchOnFocus:!1,baseQuery:(0,i.ni)({baseUrl:"/api"}),tagTypes:["Raid"],endpoints:e=>({getRaids:e.query({query:()=>"raids/v1",transformResponse:e=>e.raids,providesTags:["Raid"]}),addNewRaid:e.mutation({query:e=>({url:"raids/v1",method:"POST",body:e,header:{"Content-type":"application/json; charset=UTF-8"}}),invalidatesTags:["Raid"]}),refreshRaids:e.mutation({query:()=>"raids/v1",transformResponse:e=>e.raids,invalidatesTags:["Raid"]})})}),{useGetRaidsQuery:o,useAddNewRaidMutation:a,useRefreshRaidsMutation:l}=s}},function(e){e.O(0,[462,281,632,108,764,895,165,667,139,560],function(){return e(e.s=7083)}),_N_E=e.O()}]);